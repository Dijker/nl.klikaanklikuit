<script>
var options = {
	template: '../lib/pair/program.html',
	id: 'generic_program',
	previous: 'generic_choice',
	title: 'deviceClasses.build_in.views.generic_program.title',
	body: 'deviceClasses.build_in.views.generic_program.body',
	svg: '<?xml version="1.0" encoding="utf-8"?>\n<!-- Generator: Adobe Illustrator 20.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->\n<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 1073.17 1900.31" style="enable-background:new 0 0 1073.17 1900.31;" xml:space="preserve" xmlns:pulse="-">\n<style type="text/css">\n\t.st0{clip-path:url(#SVGID_2_);}\n\t.st1{clip-path:url(#SVGID_2_);fill-rule:evenodd;clip-rule:evenodd;fill:#000000;}\n</style>\n<g>\n\t<defs>\n\t\t<rect id="SVGID_1_" y="0" width="1073.17" height="1900.31"/>\n\t</defs>\n\t<clipPath id="SVGID_2_">\n\t\t<use xlink:href="#SVGID_1_"  style="overflow:visible;"/>\n\t</clipPath>\n\t<path class="st0" d="M1031.59,1056.67h-990c-22.93,0-41.59-18.66-41.59-41.59V41.58C0,18.65,18.65,0,41.59,0h990\n\t\tc22.93,0,41.59,18.66,41.59,41.59v973.5C1073.17,1038.01,1054.52,1056.67,1031.59,1056.67 M41.59,14.17\n\t\tc-15.12,0-27.41,12.3-27.41,27.41v973.5c0,15.12,12.3,27.41,27.41,27.41h990c15.11,0,27.41-12.3,27.41-27.41V41.58\n\t\tc0-15.11-12.3-27.41-27.41-27.41H41.59z"/>\n\t<path class="st0" d="M1030.14,1031.28H544.79c-11.44,0-20.74-9.3-20.74-20.74V44.97c0-11.44,9.31-20.74,20.74-20.74h485.35\n\t\tc11.44,0,20.74,9.3,20.74,20.74v965.56C1050.88,1021.97,1041.57,1031.28,1030.14,1031.28 M544.79,31.32\n\t\tc-7.53,0-13.66,6.13-13.66,13.66v965.56c0,7.53,6.13,13.66,13.66,13.66h485.35c7.53,0,13.66-6.13,13.66-13.66V44.97\n\t\tc0-7.53-6.13-13.66-13.66-13.66H544.79z"/>\n\t<path class="st0" d="M390.73,874.9H41.95c-8.77,0-15.9-7.14-15.9-15.9V40.13c0-8.77,7.13-15.9,15.9-15.9h348.78\n\t\tc8.77,0,15.9,7.13,15.9,15.9V859C406.63,867.77,399.5,874.9,390.73,874.9 M41.95,31.32c-4.86,0-8.82,3.96-8.82,8.82V859\n\t\tc0,4.86,3.95,8.82,8.82,8.82h348.78c4.86,0,8.82-3.96,8.82-8.82V40.13c0-4.86-3.95-8.82-8.82-8.82H41.95z"/>\n\t<polygon class="st0" points="902.65,904.78 902.65,990.77 950.75,990.77 950.75,1004.01 889.4,1004.01 889.4,904.78 \t"/>\n\t<path class="st0" d="M618.35,997.32l38.35-33.85c-14.4-9.8-29.65-16.3-49.02-4.16l-4.73-7.56c25.01-15.67,43.35-6.61,60.66,5.62\n\t\tl38.57-34.04l-5.09-5.77l24.73-5.54c-2.85,7.95-5.7,15.9-8.56,23.85c-1.72-1.95-3.44-3.9-5.16-5.85L671,962.75l0.46,0.34\n\t\tc19.49,14.44,38.73,28.69,67.11,1.97l6.13,6.51c-33.82,31.84-56.04,15.37-78.56-1.31l-1.99-1.47l-39.89,35.21L618.35,997.32z"/>\n\t<polygon class="st0" points="127.01,1004.01 127.01,903.86 140.62,903.86 193.17,982.47 193.17,903.86 205.9,903.86 205.9,1004.01\n\t\t192.28,1004.01 139.74,925.4 139.74,1004.01 \t"/>\n\t<polygon class="st0" points="377.08,1004.01 377.08,903.86 390.69,903.86 443.24,982.47 443.24,903.86 455.97,903.86\n\t\t455.97,1004.01 442.35,1004.01 389.81,925.4 389.81,1004.01 \t"/>\n\t<path class="st0" d="M465.26,163.68c-16.01,0-29.04-13.03-29.04-29.04c0-16.01,13.03-29.04,29.04-29.04\n\t\tc16.01,0,29.04,13.03,29.04,29.04C494.3,150.65,481.27,163.68,465.26,163.68 M465.26,112.68c-12.11,0-21.96,9.85-21.96,21.96\n\t\tc0,12.11,9.85,21.96,21.96,21.96c12.11,0,21.96-9.85,21.96-21.96C487.21,122.53,477.36,112.68,465.26,112.68"/>\n\t<path class="st0" d="M465.26,340.68c-22.63,0-41.04-18.41-41.04-41.04c0-22.63,18.41-41.04,41.04-41.04\n\t\tc22.63,0,41.04,18.41,41.04,41.04C506.3,322.27,487.89,340.68,465.26,340.68 M465.26,265.68c-18.72,0-33.96,15.23-33.96,33.96\n\t\tc0,18.72,15.23,33.96,33.96,33.96c18.72,0,33.96-15.23,33.96-33.96C499.21,280.92,483.98,265.68,465.26,265.68"/>\n\t<path pulse:initial="true" class="st1" d="M465.26,265.7c18.74,0,33.94,15.19,33.94,33.94c0,18.74-15.19,33.94-33.94,33.94\n\t\tc-18.74,0-33.94-15.19-33.94-33.94C431.32,280.9,446.52,265.7,465.26,265.7"/>\n\t<path class="st0" d="M380.81,1900.31h69.45v-855.66h-69.45V1900.31z M387.9,1051.74h55.27v841.49H387.9V1051.74z"/>\n\t<path class="st0" d="M630.26,1900.31h69.45v-855.66h-69.45V1900.31z M637.35,1051.74h55.28v841.49h-55.28V1051.74z"/>\n\t<path class="st0" d="M215.3,1532.47h-14.49v-487.82h-69.45v487.82h-14.49v21H79.39v267.64H103v32.7h126.17v-32.7h23.61v-267.64\n\t\tH215.3V1532.47z M138.45,1051.74h55.27v480.74h-55.27V1051.74z M123.96,1539.56h7.4h69.45h7.4v13.91h-84.25V1539.56z\n\t\t M222.09,1846.72h-112v-25.62h112V1846.72z M245.7,1560.56v253.46h-16.52H103H86.48v-253.46h30.4h98.43H245.7z"/>\n\t<path class="st0" d="M1001.13,1553.47h-37.48v-21h-14.49v-487.82h-69.45v487.82h-14.49v21h-37.49v267.64h23.61v32.7h126.17v-32.7\n\t\th23.61V1553.47z M886.79,1051.73h55.28v480.74h-55.28V1051.73z M872.31,1539.56h7.4h69.45h7.4v13.91h-84.25V1539.56z\n\t\t M970.43,1846.72h-112v-25.62h112V1846.72z M994.04,1814.02h-16.52H851.35h-16.53v-253.46h30.4h98.42h30.4V1814.02z"/>\n</g>\n</svg>\n',
	svgWidth: '80vw',
	svgHeight: '70vh',
	initWithDeviceData: false,
	next: true
};
Homey.setTitle(__(options.title || ''));
Homey.emit('init', options.id);
Homey.on('show_view', function(viewId){
	Homey.showView(viewId);
});
Homey.on('close', function(){
	Homey.close();
});
Homey.on('nextView', function(viewsIds){
	var viewIndex = viewsIds.indexOf(options.id) + 1;
	if(viewIndex > 0 && viewIndex < viewsIds.length){
		Homey.showView(viewsIds[viewIndex]);
	}
});
Homey.on('previousView', function(viewsIds){
	var viewIndex = viewsIds.indexOf(options.id) - 1;
	if(viewIndex >= 0){
		Homey.showView(viewsIds[viewIndex]);
	}
});
function nextView(){
	if(options.next){
		Homey.nextView();
	}else{
		Homey.emit('next');
	}
}
</script>

<link href="../../../assets/433_generator/css/styles.css" rel="stylesheet" type="text/css"/>

<link href="../../../assets/433_generator/css/svg.css" rel="stylesheet" type="text/css"/>

<script src="../../../assets/433_generator/js/svghighlighter.js" type="text/javascript"></script>

<link href="../../../assets/433_generator/css/styles.css" rel="stylesheet" type="text/css"/>

<link href="../../../assets/433_generator/css/svg.css" rel="stylesheet" type="text/css"/>

<script src="../../../assets/433_generator/js/svghighlighter.js" type="text/javascript"></script>

<div class="centered-container">
	<div id="image-container"></div>
	<div id="body"><span class="content"></span></div>
	<div class="programAnimation" id="sendProgramSignalBackground" style="display:none;"></div>
	<i class="loading fa fa-cog fa-spin programAnimation" id="sendProgramSignalSpinner" style="display:none;"></i>
</div>

<script>
	var $container = $('[data-id="' + options.id + '"] ');
	$container.find('#body > span').html(__(options.body));
	var $imageContainer = $container.find('#image-container');
	$imageContainer.css('width', options.svgWidth).css('height', options.svgHeight);
	var $programElems = $container.find('.programAnimation');

	$imageContainer.html(options.svg);
	$imageContainer.highlight();

	if (!$container.find('.view-navigation-next.dummy').length) {
		var $nextButton = $container.find('.view-navigation-next');
		var $nextButtonDummy = $nextButton.clone().addClass('dummy');
		$nextButton.hide();
		$nextButton.parent().append($nextButtonDummy);

		$nextButtonDummy.on('click', function (e) {
			$programElems.show();
			Homey.emit('program_send', function (err) {
				if (err){
					Homey.alert(err.message && err.message.indexOf(' ') === -1 && __(err.message) !== err.message ? __(err.message) : JSON.stringify(err));
					return;
				}
				$nextButtonDummy.siblings('.view-navigation-next').click();
				$programElems.hide();
			});
			e.stopPropagation();
			return false;
		});
	}

	Homey.emit('program', function(err, device){
		const dataKey = JSON.stringify(device.data);
		window.selected_devices = [ dataKey ];
		window.found_devices = {};
		window.found_devices[dataKey] = device;
	});
</script>

<style>
	#sendProgramSignalSpinner {
		z-index: 2;
		position: absolute;
		top: 25vh;
		left: 38vw;
		font-size: 9vh;
		opacity: 1;
	}

	#sendProgramSignalBackground {
		z-index: 1;
		top: 0;
		bottom: 0;
		left: 0;
		right: 0;
		position: absolute;
		background-color: #FFF;
		opacity: 0.8;
	}
</style>