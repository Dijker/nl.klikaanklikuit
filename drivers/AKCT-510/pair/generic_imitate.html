<script>
var options = {
	template: '../lib/pair/imitate.html',
	id: 'generic_imitate',
	title: 'deviceClasses.generic_remote.views.generic_imitate.title',
	body: 'deviceClasses.generic_remote.views.generic_imitate.body',
	svg: '<?xml version="1.0" encoding="utf-8"?>\n<!-- Generator: Adobe Illustrator 17.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t width="44.651px" height="85.779px" viewBox="0 8.711 44.651 85.779" enable-background="new 0 8.711 44.651 85.779"\n\t xml:space="preserve" style="transform: rotate(180deg); transform-origin: 50%;" xmlns:pulse="-">\n<path d="M23.067,85.986c0.424,0,0.809,0.172,1.087,0.45s0.45,0.662,0.45,1.087c0,0.424-0.172,0.809-0.45,1.087\n\ts-0.663,0.45-1.087,0.45c-0.425,0-0.809-0.172-1.087-0.45s-0.45-0.663-0.45-1.087c0-0.424,0.172-0.809,0.45-1.087\n\tS22.643,85.986,23.067,85.986"/>\n<path d="M24.285,86.305c-0.312-0.312-0.742-0.504-1.218-0.504s-0.906,0.193-1.218,0.504c-0.312,0.312-0.505,0.742-0.505,1.218\n\tc0,0.476,0.193,0.906,0.505,1.218c0.312,0.312,0.742,0.505,1.218,0.505c0.475,0,0.906-0.193,1.218-0.505s0.504-0.742,0.504-1.218\n\tC24.789,87.048,24.597,86.617,24.285,86.305 M23.067,85.531c0.55,0,1.048,0.223,1.409,0.583c0.36,0.361,0.583,0.859,0.583,1.409\n\tc0,0.55-0.223,1.048-0.583,1.409c-0.361,0.361-0.859,0.584-1.409,0.584c-0.55,0-1.048-0.223-1.408-0.584\n\tc-0.361-0.36-0.584-0.858-0.584-1.409c0-0.55,0.223-1.048,0.584-1.409C22.019,85.754,22.517,85.531,23.067,85.531z"/>\n<path d="M24.285,86.305c-0.312-0.312-0.742-0.504-1.218-0.504s-0.906,0.193-1.218,0.504c-0.312,0.312-0.505,0.742-0.505,1.218\n\tc0,0.476,0.193,0.906,0.505,1.218c0.312,0.312,0.742,0.505,1.218,0.505c0.475,0,0.906-0.193,1.218-0.505s0.504-0.742,0.504-1.218\n\tC24.789,87.048,24.597,86.617,24.285,86.305 M23.067,85.531c0.55,0,1.048,0.223,1.409,0.583c0.36,0.361,0.583,0.859,0.583,1.409\n\tc0,0.55-0.223,1.048-0.583,1.409c-0.361,0.361-0.859,0.584-1.409,0.584c-0.55,0-1.048-0.223-1.408-0.584\n\tc-0.361-0.36-0.584-0.858-0.584-1.409c0-0.55,0.223-1.048,0.584-1.409C22.019,85.754,22.517,85.531,23.067,85.531z"/>\n<path pulse:initial="true" pulse:state="1" fill="#000000" d="M32.854,74.851c-0.465-0.997-1.31-1.819-2.42-2.223l-12.647-4.603c-1.11-0.404-2.284-0.317-3.281,0.147\n\tc-0.994,0.464-1.814,1.304-2.219,2.409l-0.001,0.002l-0.003,0.01c-0.404,1.111-0.318,2.285,0.147,3.282s1.31,1.819,2.42,2.223\n\tL27.496,80.7c1.111,0.405,2.285,0.318,3.282-0.147c0.997-0.465,1.819-1.309,2.223-2.42l0.013-0.037v-0.001\n\tC33.403,76.997,33.314,75.837,32.854,74.851z M22.996,75.781c0,0.196-0.159,0.354-0.354,0.354s-0.354-0.159-0.354-0.354v-2.836\n\tc0-0.196,0.159-0.354,0.354-0.354s0.354,0.159,0.354,0.354V75.781z"/>\n<path d="M30.775,71.695l-12.611-4.59l0,0l-0.036-0.013c-1.367-0.497-2.813-0.391-4.041,0.182c-1.226,0.572-2.235,1.607-2.733,2.97\n\tl-0.003,0.009c-0.497,1.367-0.391,2.813,0.182,4.042h-0.001c0.573,1.228,1.612,2.239,2.979,2.736l12.611,4.59l0.037,0.013\n\tc1.367,0.497,2.813,0.391,4.041-0.182c1.225-0.571,2.233-1.606,2.732-2.967l0.004-0.012c0.498-1.367,0.391-2.813-0.182-4.042h0.001\n\tC33.181,73.204,32.142,72.193,30.775,71.695 M18.272,66.694l12.647,4.603c1.477,0.537,2.6,1.63,3.219,2.956h0.001\n\tc0.613,1.314,0.73,2.861,0.208,4.328v0.001l-0.013,0.037c-0.538,1.478-1.63,2.601-2.956,3.22c-1.315,0.613-2.861,0.73-4.328,0.208\n\th-0.001l-0.036-0.013l-12.647-4.603c-1.477-0.537-2.6-1.63-3.219-2.956h-0.001c-0.613-1.314-0.73-2.861-0.208-4.328v-0.001\n\tl0.013-0.037c0.538-1.478,1.63-2.601,2.956-3.22c1.315-0.613,2.861-0.73,4.328-0.208h0.001L18.272,66.694z"/>\n<g pulse:state="0">\n\t<path d="M32.854,56.669c-0.465-0.997-1.31-1.819-2.42-2.223l-12.647-4.603c-1.11-0.404-2.284-0.317-3.281,0.147\n\t\tc-0.994,0.464-1.814,1.304-2.219,2.409l-0.001,0.002l-0.003,0.01c-0.404,1.111-0.318,2.285,0.147,3.282s1.31,1.819,2.42,2.223\n\t\tl12.646,4.603c1.111,0.405,2.285,0.318,3.282-0.147c0.997-0.465,1.819-1.309,2.223-2.42l0.013-0.037v-0.001\n\t\tC33.403,58.815,33.314,57.655,32.854,56.669z M24.046,57.582L24.046,57.582l-0.002,0.002c-0.359,0.359-0.855,0.581-1.402,0.581\n\t\tc-0.548,0-1.045-0.222-1.403-0.581l0.001-0.001c-0.359-0.359-0.582-0.855-0.582-1.403c0-0.548,0.222-1.045,0.581-1.403\n\t\ts0.855-0.581,1.403-0.581c0.547,0,1.043,0.223,1.403,0.582l0.001-0.001c0.359,0.359,0.581,0.855,0.581,1.403\n\t\tC24.627,56.727,24.405,57.223,24.046,57.582z"/>\n\t<path d="M23.544,55.277L23.544,55.277c-0.229-0.23-0.548-0.372-0.901-0.372c-0.352,0-0.671,0.143-0.902,0.374\n\t\tc-0.231,0.231-0.374,0.55-0.374,0.902c0,0.353,0.143,0.673,0.372,0.902h0.001c0.231,0.231,0.55,0.374,0.902,0.374\n\t\tc0.353,0,0.673-0.143,0.902-0.373l0.001-0.001c0.23-0.23,0.373-0.549,0.373-0.902c0-0.352-0.143-0.672-0.374-0.902\n\t\tC23.544,55.279,23.544,55.277,23.544,55.277z"/>\n</g>\n<path d="M30.775,53.513l-12.611-4.59l0,0l-0.036-0.013c-1.367-0.497-2.813-0.391-4.041,0.182c-1.226,0.572-2.235,1.607-2.733,2.97\n\tl-0.003,0.009c-0.497,1.367-0.391,2.813,0.182,4.042h-0.001c0.573,1.228,1.612,2.239,2.979,2.736l12.611,4.59l0.037,0.013\n\tc1.367,0.497,2.813,0.391,4.041-0.182c1.225-0.571,2.233-1.606,2.732-2.967l0.004-0.012c0.498-1.367,0.391-2.813-0.182-4.042h0.001\n\tC33.181,55.022,32.142,54.011,30.775,53.513 M18.272,48.512l12.647,4.603c1.477,0.537,2.6,1.63,3.219,2.956h0.001\n\tc0.613,1.314,0.73,2.861,0.208,4.328V60.4l-0.013,0.037c-0.538,1.478-1.63,2.601-2.956,3.22c-1.315,0.613-2.861,0.73-4.328,0.208\n\th-0.001l-0.036-0.013l-12.647-4.603c-1.477-0.538-2.6-1.63-3.219-2.956h-0.001c-0.613-1.315-0.73-2.861-0.208-4.328v-0.001\n\tl0.013-0.037c0.538-1.478,1.63-2.601,2.956-3.22c1.315-0.613,2.861-0.73,4.328-0.208h0.001L18.272,48.512z"/>\n<path d="M42.829,9.561c0.268,0,0.511,0.109,0.686,0.284l0.002,0.002c0.175,0.176,0.284,0.418,0.284,0.686v82.135\n\tc0,0.268-0.109,0.511-0.284,0.686l-0.002,0.002c-0.176,0.175-0.418,0.284-0.686,0.284H1.822c-0.267,0-0.51-0.11-0.686-0.286\n\tl-0.001,0.001c-0.176-0.177-0.285-0.42-0.285-0.687V10.533c0-0.266,0.11-0.51,0.286-0.686s0.419-0.286,0.686-0.286h13.979H42.829\n\tV9.136V8.711H15.376h-1.441H1.823c-0.502,0-0.958,0.205-1.288,0.535C0.205,9.575,0,10.031,0,10.533v82.135\n\tc0,0.5,0.205,0.956,0.534,1.285v0.002c0.33,0.33,0.786,0.535,1.288,0.535h41.007c0.499,0,0.954-0.205,1.285-0.535l0.001-0.001\n\tl0.001-0.001c0.33-0.33,0.535-0.785,0.535-1.285V10.533c0-0.499-0.205-0.955-0.535-1.285l-0.001-0.001l-0.001-0.001\n\tc-0.33-0.33-0.785-0.535-1.285-0.535"/>\n</svg>\n',
	svgWidth: '80vw',
	svgHeight: '70vh',
	initWithDeviceData: false,
	previous: true,
	next: false
};
Homey.setTitle(__(options.title || ''));
Homey.emit('init', options.id);
Homey.on('show_view', function(viewId){
	Homey.showView(viewId);
});
Homey.on('close', function(){
	Homey.close();
});
Homey.on('nextView', function(viewsIds){
	var viewIndex = viewsIds.indexOf(options.id) + 1;
	if(viewIndex > 0 && viewIndex < viewsIds.length){
		Homey.showView(viewsIds[viewIndex]);
	}
});
Homey.on('previousView', function(viewsIds){
	var viewIndex = viewsIds.indexOf(options.id) - 1;
	if(viewIndex >= 0){
		Homey.showView(viewsIds[viewIndex]);
	}
});
function nextView(){
	if(options.next){
		Homey.nextView();
	}else{
		Homey.emit('next');
	}
}
</script>

<link href="../../../assets/433_generator/css/styles.css" rel="stylesheet" type="text/css"/>

<link href="../../../assets/433_generator/css/svg.css" rel="stylesheet" type="text/css"/>

<script src="../../../assets/433_generator/js/svghighlighter.js" type="text/javascript"></script>

<div class="centered-container">
	<div id="image-container"></div>
	<div id="body"><span class="content"></span></div>
	<div class="foundAnimation" id="foundBackground" style="display:none;"></div>
	<i class="fa fa-check-circle foundAnimation" id="found" style="display:none;" aria-hidden="true"></i>
</div>

<script>
	var idPrefix = '[data-id="' + options.id + '"] ';
	$(idPrefix + '#body > span').html(__(options.body));
	var $imageContainer = $(idPrefix + '#image-container');
	$imageContainer.css('width', options.svgWidth).css('height', options.svgHeight);

	$imageContainer.html(options.svg);
	$imageContainer.highlight();

	var found = false;
	Homey.on('frame', function (data) {
		if(!found) {
			found = true;
			Homey.emit('set_device', data, function (err, device) {
				if (err) {
					Homey.alert(__(err.message || err));
					found = false;
					return;
				}
				const dataKey = JSON.stringify(device.data);
				window.selected_devices = [ dataKey ];
				window.found_devices = {};
				window.found_devices[dataKey] = device;
				var $foundElems = $(idPrefix + '.foundAnimation');
				$foundElems.show();
				setTimeout(function () {
					$foundElems.addClass('fadeOut');
					setTimeout(nextView, 400);
				}, 500);
			});
		}
	});
</script>

<style>
	#found {
		z-index: 2;
		position: absolute;
		top: 20vh;
		left: 38vw;
		font-size: 30vh;
		color: #080;
		opacity: 1;
	}

	#foundBackground {
		z-index: 1;
		top: 0;
		bottom: 0;
		left: 0;
		right: 0;
		position: absolute;
		background-color: #FFF;
		opacity: 0.8;
	}

	.fadeOut {
		-webkit-transition: all 0.5s ease-in-out;
		-moz-transition: all 0.5s ease-in-out;
		-ms-transition: all 0.5s ease-in-out;
		-o-transition: all 0.5s ease-in-out;
		transition: all 0.5s ease-in-out;
		opacity: 0 !important;
	}
</style>